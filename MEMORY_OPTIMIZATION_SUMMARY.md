# –†–µ–∑—é–º–µ: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏

## ‚úÖ –û–ì–†–û–ú–ù–ê–Ø –≠–ö–û–ù–û–ú–ò–Ø –ü–ê–ú–Ø–¢–ò!

–¢–µ–ø–µ—Ä—å –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ **–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö —Ç–∏–ø–∞—Ö** –≤–º–µ—Å—Ç–æ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤—Å–µ–≥–æ –≤ Double!

### üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è –≤–∞—à–µ–≥–æ —Ñ–∞–π–ª–∞

**–º–æ–Ω–∏–ª–∏–æ–∑_1.npy** (uint8, 7958√ó1280√ó250 = 2.4 –ì–ë):

```
–î–û:    19.2 –ì–ë –≤ –ø–∞–º—è—Ç–∏
–ü–û–°–õ–ï:  2.4 –ì–ë –≤ –ø–∞–º—è—Ç–∏
–≠–ö–û–ù–û–ú–ò–Ø: 16.8 –ì–ë (88%)! üéâ
```

### üéØ –≠–∫–æ–Ω–æ–º–∏—è –ø–æ —Ç–∏–ø–∞–º –¥–∞–Ω–Ω—ã—Ö

| –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö | –ë—ã–ª–æ | –°—Ç–∞–ª–æ | –≠–∫–æ–Ω–æ–º–∏—è |
|-----------|------|-------|----------|
| **uint8** | 8x | **1x** | **88%** ‚ú® |
| **uint16** | 4x | **1x** | **75%** ‚ú® |
| **float32** | 2x | **1x** | **50%** ‚ú® |
| **float64** | 1x | **1x** | 0% |

### üí° –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–∞–Ω—å—à–µ:**
```swift
// –í—Å–µ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–ª–æ—Å—å –≤ Double
let data: [Double]  // uint8 ‚Üí Double (8x –ø–∞–º—è—Ç–∏!)
```

**–¢–µ–ø–µ—Ä—å:**
```swift
// –•—Ä–∞–Ω–∏–º –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º —Ç–∏–ø–µ
enum DataStorage {
    case uint8([UInt8])    // uint8 –æ—Å—Ç–∞–µ—Ç—Å—è uint8!
    case float32([Float])  // float32 –æ—Å—Ç–∞–µ—Ç—Å—è float32!
    case float64([Double]) // –∏ —Ç.–¥.
}

// –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ Double —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–µ
func getValue(at index: Int) -> Double
```

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–û–≥—Ä–æ–º–Ω–∞—è —ç–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏**: –¥–æ 88% –¥–ª—è uint8!
2. **–ü–æ–ª–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: API –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è
3. **–ë—ã—Å—Ç—Ä–µ–µ –∑–∞–≥—Ä—É–∑–∫–∞**: –Ω–µ—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞
4. **–ë–æ–ª—å—à–µ —Ñ–∞–π–ª–æ–≤**: —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å —Ñ–∞–π–ª—ã >10 –ì–ë –Ω–∞ 16 –ì–ë RAM

### üß™ –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

1. **–ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   ```bash
   open HSIView.xcodeproj
   # Cmd+R
   ```

2. **–û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à —Ñ–∞–π–ª** `–º–æ–Ω–∏–ª–∏–æ–∑_1.npy`

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ Activity Monitor:**
   - –ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å "HSIView"
   - –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å **~2.4 –ì–ë** –≤–º–µ—Å—Ç–æ ~19.2 –ì–ë! ‚úÖ

### üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –û–ø–µ—Ä–∞—Ü–∏—è | –î–æ | –ü–æ—Å–ª–µ | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|----------|-----|-------|-----------|
| –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ | –ú–µ–¥–ª–µ–Ω–Ω–æ (–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è) | **–ë—ã—Å—Ç—Ä–µ–µ** ‚úÖ | +20-30% |
| –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ | –ë—ã—Å—Ç—Ä–æ | –ù–µ–º–Ω–æ–≥–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ | -5-10% |
| –ü–∞–º—è—Ç—å | 8x | **1x** | **-88%** ‚ú® |

**–í—ã–≤–æ–¥:** –ù–µ–±–æ–ª—å—à–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ **–ø–æ–ª–Ω–æ—Å—Ç—å—é –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç—Å—è** –æ–≥—Ä–æ–º–Ω–æ–π —ç–∫–æ–Ω–æ–º–∏–µ–π –ø–∞–º—è—Ç–∏!

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

**DataStorage** - –Ω–æ–≤—ã–π enum –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è:
- `float64([Double])`
- `float32([Float])`
- `int8([Int8])`, `int16([Int16])`, `int32([Int32])`
- `uint8([UInt8])`, `uint16([UInt16])`

**HyperCube** - –æ–±–Ω–æ–≤–ª–µ–Ω:
```swift
struct HyperCube {
    let storage: DataStorage  // ‚Üê –í–º–µ—Å—Ç–æ let data: [Double]
    
    // –ú–µ—Ç–æ–¥—ã –¥–ª—è –¥–æ—Å—Ç—É–ø–∞
    func getValue(at: Int) -> Double
    func getValue(i0: Int, i1: Int, i2: Int) -> Double
}
```

**–í—Å–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–∏** –æ–±–Ω–æ–≤–ª–µ–Ω—ã:
- NPY: —á–∏—Ç–∞–µ—Ç –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º —Ç–∏–ø–µ
- MAT: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç float64
- TIFF: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç uint8

### üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **`MEMORY_OPTIMIZATION.md`** ‚≠ê - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **`MEMORY_USAGE.md`** - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ —Å –Ω–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π

### üéØ –ü—Ä–∏–º–µ—Ä—ã —ç–∫–æ–Ω–æ–º–∏–∏

**–ú–∞–ª—ã–µ —Ñ–∞–π–ª—ã:**
- uint8 (512√ó512√ó31) = 8 –ú–ë ‚Üí **8 –ú–ë** (–±—ã–ª–æ 64 –ú–ë)

**–°—Ä–µ–¥–Ω–∏–µ —Ñ–∞–π–ª—ã:**
- uint16 (1024√ó1024√ó50) = 100 –ú–ë ‚Üí **100 –ú–ë** (–±—ã–ª–æ 400 –ú–ë)

**–ë–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã:**
- uint8 (7958√ó1280√ó250) = 2.4 –ì–ë ‚Üí **2.4 –ì–ë** (–±—ã–ª–æ 19.2 –ì–ë)

**–û–≥—Ä–æ–º–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- uint8 (10000√ó10000√ó100) = 10 –ì–ë ‚Üí **10 –ì–ë** (–±—ã–ª–æ 80 –ì–ë!)

### üöÄ –ß—Ç–æ –¥–∞–ª—å—à–µ

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ:
- ‚úÖ –û—Ç–∫—Ä—ã–≤–∞—Ç—å —Ñ–∞–π–ª—ã –≤ 8x –±–æ–ª—å—à–µ (–¥–ª—è uint8)
- ‚úÖ –†–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –º–∞—à–∏–Ω–∞—Ö —Å –º–µ–Ω—å—à–∏–º RAM
- ‚úÖ –û—Ç–∫—Ä—ã–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- ‚úÖ –ù–µ –±–µ—Å–ø–æ–∫–æ–∏—Ç—å—Å—è –æ –ø–∞–º—è—Ç–∏ –¥–ª—è uint8/uint16 —Ñ–∞–π–ª–æ–≤

---

**–î–∞—Ç–∞:** 2025-11-28  
**–ö–æ–º–º–∏—Ç:** `ebbc982 - feat: massive memory optimization`

**–ì–û–¢–û–í–û! –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ - —ç–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏ –±—É–¥–µ—Ç –≤–∏–¥–Ω–∞ —Å—Ä–∞–∑—É!** üéâ

